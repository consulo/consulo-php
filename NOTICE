Initial code was getted from http://idea-php.sourceforge.net as AS-IS, author Jay.